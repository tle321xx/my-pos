<div class="card h-100 border-0 shadow-sm user-select-none" 
     [class.border-success]="quantity > 0" 
     [class.border]="quantity > 0"
     style="cursor: pointer; transition: transform 0.2s;"
     (click)="onAdd($event)">
  
  <div class="position-relative bg-light" style="height: 140px;">
    <img *ngIf="product.image" [src]="product.image" class="card-img-top h-100 w-100 object-fit-cover" alt="img">
    <div *ngIf="!product.image" class="d-flex align-items-center justify-content-center h-100 text-secondary fs-1">
      <i class="bi bi-camera"></i>
    </div>
    
    <div class="position-absolute top-0 start-0 p-2 d-flex flex-wrap gap-1">
       <span *ngIf="product.thc" class="badge bg-dark text-success border border-success">THC {{product.thc}}%</span>
       <span *ngIf="product.strain" class="badge bg-opacity-75" 
             [ngClass]="{'bg-purple': product.strain === 'Indica', 'bg-warning': product.strain === 'Sativa', 'bg-info': product.strain === 'Hybrid'}">
         {{product.strain}}
       </span>
       <span *ngIf="product.tags?.includes('3g100')" class="badge bg-danger">PROMO</span>
    </div>
  </div>

  <div class="card-body p-2 d-flex flex-column text-center">
    <h6 class="card-title fw-bold text-truncate mb-1">{{product.name}}</h6>
    
    <div *ngIf="product.category === 'weed'" class="small text-muted mb-auto">
      <div *ngIf="product.ratio" class="text-truncate"><small>üß¨ {{product.ratio}}</small></div>
      <div *ngIf="product.scent" class="text-truncate"><small>üëÉ {{product.scent}}</small></div>
    </div>

    <div *ngIf="product.category !== 'weed'" class="small text-muted mb-auto">
       <span *ngIf="product.unit === 'g'">{{product.weight}}g</span>
       <span *ngIf="product.unit !== 'g'">{{product.unit}}</span>
    </div>

    <div class="fw-bold text-success mt-2">{{product.price | number}} ‡∏ø</div>
  </div>

  <div class="card-footer p-2 bg-white border-0">
    <button *ngIf="quantity === 0" class="btn btn-outline-success w-100 btn-sm fw-bold">
      + ‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
    </button>

    <div *ngIf="quantity > 0" class="d-flex justify-content-between align-items-center bg-success text-white rounded p-1">
      <button class="btn btn-sm btn-success p-0 px-2" (click)="onRemove($event)"><i class="bi bi-dash"></i></button>
      <span class="fw-bold">{{quantity}}</span>
      <button class="btn btn-sm btn-success p-0 px-2" (click)="onAdd($event)"><i class="bi bi-plus"></i></button>
    </div>
  </div>

</div>